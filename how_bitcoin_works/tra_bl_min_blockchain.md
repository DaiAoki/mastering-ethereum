## トランザクション、ブロック、採掘、そしてブロックチェーン

伝統的な銀行や支払システムと異なり、ビットコインは「分散システム上での信用」が土台となっています。信用のおける中央機関の代わりに、ビットコインではシステムへの様々な参加者が相互に作用しあうことで信用が形成されます。本章では一つのトランザクションの動きを追うことで、そのトランザクションの正当性への合意が分散システムの中で形成され、最終的に分散型元帳であるブロックチェーンに記録される様子を見ていきます。

ここで示す例は実際にビットコイン・ネットワークで行われたトランザクションに基づいており、それぞれのユーザー（Joe、Alice、Bob）のウォレット間の資金のやり取りをシミュレートしたものです。トランザクションの動きを実際に追うため、ここでは *ブロックチェーン・エクスプローラ* を利用します。このブロックチェーン・エクスプローラは、アドレス、トランザクション、ブロックや、それらの間の関連性を探索することができる検索エンジンの機能を持つWebアプリケーションです。

よく知られたブロックチェーン・エクスプローラとしては、

* [Blockchain info](http://blockchain.info)
* [Bitcoin Block Explorer](http://blockexplorer.com)
* [insight](http://insight.bitpay.com)
* [blockr Block Reader](http://blockr.io)

というようなものがあります。それぞれ、アドレスやトランザクション・ハッシュまたはブロック番号を実際のビットコイン・ネットワークの中から検索できる機能を持ちます。読者がより詳しく見ていけるよう、今後示す例の中では実際のエントリーに直接リンクされたURLを示していきます。

### ビットコイン概観

下図にビットコイン・システムの概観を示します。ビットコイン・システムは秘密鍵を持つウォレット、ネットワークの中を伝搬するトランザクション、計算競争をつうじて全てのトランザクションの元帳となるブロックチェーンを生み出していく採掘者といったものから構成されていることがわかります。本章では一つのトランザクションを通じてビットコイン・システムのそれぞれの部分がどのようなやり取りをするのかの概観を見ていきます。そして後続の章では、ウォレットや採掘などの内側のテクノロジーをさらに掘り下げて見ていくことにします。

!["ビットコイン概観"](00_images/msbt_0201.png "ビットコイン概観")

ビットコイン概観

＜最初のビットコインを手に入れる＞節で見たとおり、Aliceは友人のJoeから現金と引き換えにビットコインを入手しました。その中でJoeによってAliceのウォレットに0.10 BTC を送金するトランザクションが生成されました。今度はカリフォルニアのパロアルトにあるBobのカフェでAliceが一杯のコーヒーを購入するところを見ていきます。Bobのカフェでは最近、店頭システムにビットコインでの支払いを受けることができる機能を追加しました。メニューには地域の通貨（USドル）を記載していますが、客はUSドル、ビットコインどちらでも支払が可能です。店頭システムは、ビットコインでの値段をUSドルとの市場レートを元に計算し、USドルとビットコイン両方の値段を表示します。さらにビットコインの場合は支払いリクエスト情報がQRコードで表示されます ( ＜支払依頼QRコード＞図)。

```
合計:
1.50 USD
0.015 BTC
```
!["支払依頼QRコード（ヒント：実際にスキャンしてみよう！）"](00_images/msbt_0202.png "支払依頼QRコード")

支払依頼QRコード（ヒント：実際にスキャンしてみよう！）

支払依頼QRコードはBIP0021にて定義された下記のURLをエンコードしたものです。
```
bitcoin:1GdK9UzpHBzqzX2A9JFP3Di4weBwqgmoQA?amount=0.015&label=Bob%27s%20Cafe&message=Purchase%20at%20Bob%27s%20Cafe

URLの内容:
支払先のビットコイン・アドレス: "1GdK9UzpHBzqzX2A9JFP3Di4weBwqgmoQA"
支払額："0.015"
支払先アドレスのラベル："Bob's Cafe"
支払品目: "Purchase at Bob's Cafe"
```

****
**【TIP】**

単純なビットコイン・アドレスのQRコードとは異なり、支払依頼のQRコードは支払先ビットコイン・アドレス、支払額、"Bob's Cafe."といったような属性情報を含みます。これにより支払の処理に必要な情報がウォレット・アプリに自動で入力され、かつ人間に親しみやすい情報としてアプリ上に表示することが可能になります。実際にウォレット・アプリケーションでこのQRコードをスキャンし、Aliceにどのような情報が表示されるのかを見てみてください。
****

Bobは、1.5$ もしくは0.0150BTC になる旨をAliceに伝えます。

AliceはスマートフォンでQRコードをスキャンします。スマートフォンに*Bob's Cafe*への *0.0150 BTC*の支払依頼の情報が表示され、 *Send* ボタンを押すことで支払いを承認します。（クレジットカードでの承認と同様）数秒のうちにボブは店頭システム上でも今回の支払のトランザクションを確認することでき、これで支払が完了します。

次からの節では、Aliceのウォレットがどのように構築されるのか、どのようにトランザクションがネットワーク内を伝搬し承認されるのか、またどのようにBobが受け取ったビットコインが次のトランザクションで使用されるのかといった観点で、このトランザクションについてより詳しく見ていきます。