## ビットコインのトランザクション

端的にいえば「トランザクション」とは、ビットコインの保有者が、保有する一部のビットコインを他者への送金することを認めたと、ビットコイン・ネットワークに対して伝えることです。そして新たな保有者となったオーナーは、そのビットコインを別のトランザクションにより他者に送金することが可能になりと、所有権が数珠つなぎに移り変わっていきます。

トランザクションは複式簿記台帳のそれぞれの行に似ています。簡単に言えば、それぞれのトランザクションは１つ以上の「インプット」があり、アカウントの簿記台帳の借方側に記載されます。一方で、トランザクションには１つ以上の「アウトプット」もあり、これらはアカウントの簿記台帳の貸方に記載されます。インプットとアウトプット（すなわち借方と貸方）は必ずしも同じ額ではなく、アウトプットの合計額はインプットよりも若干少なくなっています。これはトランザクション情報を元帳に記載していく採掘者へのトランザクション手数料としての支払いを示しています。トランザクションを簿記台帳のエントリーとして記載した例が下図になります。

!["複式簿記台帳として見るトランザクション"](00_images/msbt_0203.png "複式簿記台帳として見るトランザクション")

複式簿記台帳として見るトランザクション

トランザクションには、送金される側の電子署名の情報が含まれます。この電子署名は所有者に依存せず第三者が単独でその正当性の検証が可能な形式のものです。「ビットコインを使う」ということは即ち、以前のトランザクションにより所有権を得たビットコインの現所有者が新しい所有者に所有権を移すことを電子署名でサインすることを意味します。



---
**【TIP】**

トランザクションは、インプットからアウトプットに一定額のビットコインを移動させます。ここでインプットは移動対象のビットコインの出処であり、通常は以前のトランザクションのアウトプットです。またアウトプットはビットコインの所有権を新しいオーナーに鍵と一緒に紐づけます。この鍵は「制約条件」と呼ばれ、今回の送金対象のビットコインが将来のトランザクションで利用する際に必要とする電子署名になります。あるトランザクションのアウトプットはその後の新しいトランザクションでのインプットとなり、これによりビットコインの所有権があるアドレスから別のアドレスに移動していく連鎖が生まれていきます。

---

AliceからBobへの支払いは、前章で友達のJoeから現金と引き換えにビットコインを受け取ったトランザクションがインプットとなります。JoeとのトランザクションのアウトプットにはAliceの秘密鍵に紐づくロックが掛けられています（制約条件が課せられています。）。Bobとのトランザクションは、このJoeとのトランザクションをインプットとし、Bobへのコーヒー代金とお釣りの受け渡しをする新しいアウトプットが生成されます。以前のトランザクションのアウトプットが次のトランザクションのインプットとなるトランザクションの連鎖が形成されていくわけです。Aliceの秘密鍵で前回のJoeとのトランザクションのアウトプットに掛けられたロックを外すことができるので、Joeから送られたビットコインはAliceが所有者と証明され、Aliceはそれをコーヒー代の支払いのトランザクションのインプットとできます。また、コーヒー代の支払いのトランザクションではBobのアドレスを紐づけることで、このトランザクションのアウトプットを後でインプットとして利用する際にはBobの秘密鍵による署名が必要となります。これがAliceからBobにビットコインが送金されたということになるのです。このJoeからAlice、そしてBobへと続くトランザクションの連鎖を下図に示します。

!["トランザクションの連鎖：あるトランザクションのアウトプットが別のトランザクションのインプットになる様子"](00_images/msbt_0204.png "トランザクションの連鎖：あるトランザクションのアウトプットが別のトランザクションのインプットになる様子")

トランザクションの連鎖：あるトランザクションのアウトプットが別のトランザクションのインプットになる様子

### 一般的なトランザクションの形式
最も一般的なトランザクションは、ある一つのアドレスから他の一つのアドレスへ支払がなされるものです。またその中で「お釣り」が送り元のアドレスに戻されることが多くあります。そのため下図に示されたように、このタイプのトランザクションは一つのインプットと２つのアウトプットを持つことになります。

!["最も一般的なトランザクション"](00_images/msbt_0205.png "最も一般的なトランザクション")
